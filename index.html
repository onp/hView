<!doctype html>

<html lang=en>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Is it cold?">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>hView</title>
</head>

<body>
<h1>hView</h1>
<div id=content>
  <p>Waiting for data...</p>




<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-firestore.js"></script>
<script>
  // Initialize Firebase
  firebase.initializeApp({
    apiKey: "AIzaSyCch8gDaGfQhOFVroFCZHKosa3oOU-WvPE",
    authDomain: "templogger-233703.firebaseapp.com",
    projectId: "templogger-233703",
  });
  var db = firebase.firestore();
</script>

<script>
  //ref for content node
  var ct = document.querySelector('#content')
  //get last datapoint
  var tRef = db.collection("temperatures");

  tRef.orderBy('time','desc').limit(1).get().then(function(qs) {
    var d = qs.docs[0].data()
    console.log(d);

    ct.textContent = '';
    var elDate = document.createElement('p');
    elDate.textContent = d.time.toDate()

    var elTemperature = document.createElement('p');
    elTemperature.textContent = "Temperature: " + d.temp + " C"

    var elHumidity = document.createElement('p');
    elHumidity.textContent = "humidity: " + d.humidity + "%"


    ct.appendChild(elDate)
    ct.appendChild(elTemperature)
    ct.appendChild(elHumidity)

  })

</script>

</body>
</html>
